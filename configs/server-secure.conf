# Ultra-Secure OpenVPN Server Configuration
# This configuration provides maximum security for high-risk environments

# Network and Protocol Settings
port 1194
proto udp
dev tun

# Certificate and Key Files
ca ca.crt
cert server.crt
key server.key
dh none
ecdh-curve prime256v1
tls-auth ta.key 0

# Network Configuration
server 10.8.0.0 255.255.255.0
ifconfig-pool-persist ipp.txt

# Push DNS and Routes to Clients
push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS 1.1.1.1"
push "dhcp-option DNS 1.0.0.1"
push "dhcp-option DNS 8.8.8.8"
push "dhcp-option DNS 8.8.4.4"

# Client Configuration Directory
client-config-dir ccd

# Keepalive Settings
keepalive 10 120

# Maximum Security Settings
cipher AES-256-GCM
auth SHA256
tls-version-min 1.3
tls-cipher TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256

# No Compression for Security
comp-lzo no

# Logging Configuration
log-append /var/log/openvpn/openvpn.log
verb 3
mute 20

# User Authentication with PAM
plugin /usr/lib/x86_64-linux-gnu/openvpn/plugins/openvpn-plugin-auth-pam.so openvpn

# Security Enhancements
remote-cert-tls client
tls-auth ta.key 0
key-direction 0

# Prevent DNS Leaks
push "block-outside-dns"

# Disable Weak Protocols
tls-version-min 1.3

# Additional Security Options
# Disable client-to-client communication
client-to-client

# Disable duplicate CNs
duplicate-cn

# Maximum number of clients
max-clients 50

# Connection timeout
connect-retry-max 3
connect-retry 5
connect-retry-max 3

# Ping and timeout settings
ping 10
ping-restart 120
ping-timer-rem

# Status file
status /var/log/openvpn/openvpn-status.log
status-version 2

# Additional security hardening
# Disable weak DH parameters
dh none
ecdh-curve prime256v1

# Disable compression for better security
comp-lzo no

# Additional TLS security
tls-server
tls-version-min 1.3

# Disable renegotiation
reneg-sec 0

# Disable weak ciphers
cipher AES-256-GCM
auth SHA256

# Additional security options
# Disable client-to-client communication
client-to-client

# Disable duplicate CNs
duplicate-cn

# Maximum number of clients
max-clients 50

# Connection timeout
connect-retry-max 3
connect-retry 5
connect-retry-max 3

# Ping and timeout settings
ping 10
ping-restart 120
ping-timer-rem

# Status file
status /var/log/openvpn/openvpn-status.log
status-version 2

# Additional security hardening
# Disable weak DH parameters
dh none
ecdh-curve prime256v1

# Disable compression for better security
comp-lzo no

# Additional TLS security
tls-server
tls-version-min 1.3

# Disable renegotiation
reneg-sec 0

# Disable weak ciphers
cipher AES-256-GCM
auth SHA256

